{"version":3,"sources":["../../../../../assets/Script/Net/assets/Script/Net/NetUtil.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/Script/Net","sourcesContent":["/**\n * @description 网络接口与api\n * @author  pumpkye\n */\n\nclass NetUtil {\n    // readonly url: \"https://pumpkye.fun\";\n    // readonly ip: \"https://47.97.185.90\";\n    // readonly port: \"1024\";\n    readonly url = \"http://localhost\";\n    readonly port = \"3000\";\n\n    constructor() { }\n\n    /**\n     * \n     * @param url 接口url(不包含域名和ip)\n     * @param kvObj \n     */\n    formatUrl(url: string, kvObj?) {\n        url = this.url + \":\" + this.port + url\n        if (kvObj) {\n            let len = Object.getOwnPropertyNames(kvObj).length\n            let i = 0\n            url = url + \"?\"\n            for (var key in kvObj) {\n                url = url + key + \"=\" + kvObj[key]\n                i = i + 1\n                if (i < len) {\n                    url = url + \"&\"\n                }\n            }\n        }\n        // console.log(\"formatUrl:\"+url)\n        return url\n    }\n\n    /**\n     * \n     * @param url \n     * @param method post/get/...\n     * @param body 当method为post时的body\n     */\n    sendHttpRequest(url: string, method: string, body?: string) {\n        return new Promise((resolve, reject) => {\n            var xhr = new XMLHttpRequest();\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 400)) {\n                    let resObj;\n                    try {\n                        resObj = JSON.parse(xhr.responseText);\n                    } catch (e) {\n                        reject(e);\n                    }\n                    if (resObj) {\n                        resolve(resObj);\n                    } else {\n                        reject(xhr);\n                    }\n                }\n            };\n            xhr.withCredentials = false;\n            xhr.open(method, url);\n            xhr.setRequestHeader('Access-Control-Allow-Origin', '*');\n            xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET, POST');\n            xhr.setRequestHeader('Access-Control-Allow-Headers', 'x-requested-with,content-type');\n            xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n            xhr.send(body);\n        })\n    }\n\n}\n\nexport var g_NetUtil = new NetUtil()\n\n/**\n * @description 客户端发送给服务器的消息基类\n */\nclass MessageBase {\n    protected readonly url: string;\n    protected reqObj: {};   //消息结构，定义消息中需要传递的参数\n    protected resObj: {     //返回消息的结构定义，用于存储返回结果对象化之后的结果\n        success: boolean;        //success or fail\n    };\n    constructor() {\n\n    }\n    testUrl() {\n        console.log(\"testUrl:\", g_NetUtil.formatUrl(this.url, this.reqObj))\n    }\n    /**\n     * @description 将消息返回的json对象转化为对应消息的ts对象，若该函数没有被重写，则直接返回json对象，\n     * 对于返回消息不包含复杂对象结构的消息不需要重写该函数\n     * @param ret 一个json对象\n     */\n    getResObj(ret): any {\n        // this.resObj.msg = ret.msg;\n        // return this.resObj;\n        return ret;\n    }\n\n    async send() {\n        console.log('url:', this.url);\n        let url = g_NetUtil.formatUrl(this.url, this.reqObj);\n        let resObj = await g_NetUtil.sendHttpRequest(url, \"GET\");\n        return this.getResObj(resObj);\n    }\n}\n\n"]}